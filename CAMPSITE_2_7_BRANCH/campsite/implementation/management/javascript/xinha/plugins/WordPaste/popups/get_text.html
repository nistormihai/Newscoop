<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!--
 * Licensed under the terms of the GNU Lesser General Public License:
 * 		http://www.opensource.org/licenses/lgpl-license.php
 * 
 * File Name: get_text.html
 * 	This dialog is shown when, for some reason (usually security settings), 
 * 	the user is not able to paste data from the clipboard to the editor using 
 * 	the toolbar buttons or the context menu.
 * 
 * File Author:
 * 		Paul Baranowski (paul@paulbaranowski.org)
 *
 * Based on code by:
 * 		Frederico Caldeira Knabben (fredck@fckeditor.net)
 *      Holger Hees & Bernhard Pfeifer (http://www.systemconcept.de/)
-->
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="robots" content="noindex, nofollow">
    <title>Paste from Word</title>

    <script type="text/javascript" src="../../../popups/popup.js"></script>
    <link rel="stylesheet" type="text/css" href="../../../popups/popup.css" />

    <script type="text/javascript">    
    HTMLArea = window.opener.HTMLArea;
    window.resizeTo(480, 300);
    // center on parent
    var x = opener.screenX + (opener.outerWidth - window.outerWidth) / 2;
    var y = opener.screenY + (opener.outerHeight - window.outerHeight) / 2;
    window.moveTo(x, y);
    
    function _CloseOnEsc()
    {
        if ( event.keyCode == 27 )
        {
            window.close();
            return;
        }
    }
    
    /**
     * Run on page load.
     */
    function Init()
    {
       __dlg_translate('WordPaste');
       __dlg_init();
        document.body.onkeypress = _CloseOnEsc;
   		var oFrame = document.getElementById('frmData')
		oFrame.style.display = '' ;
		oFrame.contentDocument.designMode = 'on';		
    }
    
    /** 
     * OK button clicked.
     */
    function onOk()
    {
    	var sHtml = document.getElementById('frmData').contentDocument.body.innerHTML ;
        __dlg_close( sHtml );
        return true;
    }
    
    /**
     * Cancel button clicked
     */
    function onCancel()     
    {
        __dlg_close( null );
        return false;
    }
    </script>

</head>
<body scroll="no" style="OVERFLOW: hidden" onload="Init();self.focus();">
	<table height="90%" cellspacing="0" cellpadding="0" width="100%" border="0">
	<tr>
		<td>
			<span fckLang="DlgPasteMsg">The editor was not able to automaticaly execute pasting 
				because of the <STRONG>security settings</STRONG> of your browser.
				<BR>
				Please paste inside the following box using the keyboard (<STRONG>Ctrl+V</STRONG>) 
				and hit <STRONG>OK</STRONG>.</span>
		</td>
	</tr>
	<tr>
		<td valign="top" height="100%" style="BORDER-RIGHT: #000000 1px solid; BORDER-TOP: #000000 1px solid; BORDER-LEFT: #000000 1px solid; BORDER-BOTTOM: #000000 1px solid">
			<textarea id="txtData" style="BORDER-RIGHT: #000000 1px; BORDER-TOP: #000000 1px; DISPLAY: none; BORDER-LEFT: #000000 1px; WIDTH: 99%; BORDER-BOTTOM: #000000 1px; HEIGHT: 98%"></textarea>
			<iframe id="frmData" src="blank.html" height="98%" width="99%" frameborder="no" style="BORDER-RIGHT: #000000 1px; BORDER-TOP: #000000 1px; DISPLAY: none; BORDER-LEFT: #000000 1px; BORDER-BOTTOM: #000000 1px; BACKGROUND-COLOR: #ffffff"></iframe>
		</td>
	</tr>
	<tr>
	   <td style="padding-top: 5px;" align="center">
        	<form style="text-align: center;">
        	<table border="0" align="center">
        	<tr>
            	<td style="padding-right: 10px;">
                	<button type="button" name="ok" onclick="return onOk();">Ok</button>
            	</td>
            	<td>
                	<button type="button" name="cancel" onclick="return onCancel();">Cancel</button>
            	</td>
        	</table>
        	</form>
       </td>
    </tr>	   
	</table>
</body>
</html>
