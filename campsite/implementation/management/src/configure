#!/bin/sh

[ "$CAMPSITE_PACKAGE_DIR" = "" ] && cd ../../.. && . ./configure --define_start_env && cd implementation/management/src
. ${INSTALL_CONF}/conf_functions

PACKAGE_TYPE=`cat $CAMPSITE_PACKAGE_DIR/.package_type`
[ "$PACKAGE_TYPE" = "binary" ] && exit 0

var_not_modified APP_NAME && [ -f configure.h ] && [ -f dir_conf.h ] && exit 0
save_var APP_NAME

export CONF_DIR=/etc/$APP_NAME

echo -n -e "\t\tWriting configure.h header..."
cat > configure.h << EOF
/******************************************************************************

Defines used to connect to MySQL database server

WARNING!!! This file is generated. Do not edit!

******************************************************************************/

#ifndef _CONFIGURE_H
#define _CONFIGURE_H

#define DATABASE_CONF_FILE "${CONF_DIR}/database.conf"

#endif
EOF
[ $? -ne 0 ] && echo "ERROR" && exit 1
echo OK

echo -n -e "\t\tWriting dir_conf.h header..."
m4 ../macros.m4 dir_conf.m4 > dir_conf.h
[ $? -ne 0 ] && echo "ERROR" && exit 1
echo OK
